name: CI/CD Pipeline
on:
 push:
  branches: [main, develop]
 pull_request:
  branches: [main, develop]

env:
  DOTNET_VERSION: '9.0.x'

jobs:
    build:  
      runs-on: ubuntu-latest

      steps:
          - name: Checkout
            uses: actions/checkout@v4

          - name: Setup .NET
            uses: actions/setup-dotnet@v4
            with:
              dotnet-version: ${{ env.DOTNET_VERSION }}
          
          - name: Cache NuGet packages
            uses: actions/cache@v4
            with:
                path: ~/.nuget/packages
                key: ${{ runner.os }}-nuget-${{ hashFiles('**/packages.lock.json', '**/*.csproj') }}
                restore-keys: |
                    ${{ runner.os }}-nuget-
          
          - name: Restore
            run: dotnet restore backend/EducaOnline.sln

          - name: Build
            run: dotnet build backend/EducaOnline.sln -c Release --no-restore